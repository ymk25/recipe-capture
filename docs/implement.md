# RecipeCapture 実装TODO

## 概要

RecipeCaptureアプリケーションの実装タスクリストです。エピック（Epic）=
PR単位、TODO = コミット単位で整理しています。

**更新**: React Native
UI開発を優先し、モックAPIを使用して画面が動作するように実装順序を変更しました。

---

## Phase 1: React Native UI開発（モックAPI使用）

### Epic 1: React Native アプリ基盤とモックAPI (PR: feat/setup-react-native-mock)

#### TODO リスト:

- [x] `feat: Expo TypeScript プロジェクトの初期設定`
  - プロジェクト構造の作成
  - TypeScript設定の最適化
  - 絶対パスインポートの設定docs/implement.md

- [ ] `feat: React Navigation の設定と基本画面構造の作成`
  - NavigationContainer の設定
  - スタックナビゲーターの作成
  - タブナビゲーターの作成
  - 基本画面コンポーネントのスケルトン作成

- [ ] `feat: Redux Toolkit のストア設定と基本スライスの作成`
  - ストアの設定
  - authSlice の作成
  - recipeSlice の作成
  - TypeScript型定義の追加

- [ ] `feat: React Native Paper テーマとグローバルスタイルの設定`
  - カスタムテーマの作成
  - ダークモード対応
  - 共通スタイルシートの作成

- [ ] `feat: モックAPIサービスの実装`
  - モックデータの作成（レシピ、ユーザー、解析結果）
  - API呼び出しをシミュレートする関数群
  - 遅延処理でリアルなレスポンスを再現
  - エラーケースのシミュレーション

- [ ] `test: React Native コンポーネントのテスト環境設定`
  - React Native Testing Library の設定
  - 基本的なテストユーティリティの作成

### Epic 2: レシピ管理画面UI実装 (PR: feat/recipe-management-ui)

#### TODO リスト:

- [ ] `feat: レシピ一覧画面の実装`
  - FlatList を使用したリスト表示
  - レシピカードコンポーネントの作成
  - プルトゥリフレッシュ機能
  - 無限スクロール（ページネーション）
  - 空状態とローディング状態のUI

- [ ] `feat: レシピ詳細画面の実装`
  - レシピ情報の表示レイアウト
  - 材料リストコンポーネント（人数調整機能付き）
  - 調理手順コンポーネント（ステップ表示）
  - 画像ギャラリーコンポーネント
  - お気に入りボタンとシェア機能

- [ ] `feat: レシピ編集画面の実装`
  - React Hook Form を使用したフォーム
  - 材料の追加・削除・編集UI
  - 手順の追加・削除・並び替えUI
  - 画像アップロードUI（モック）
  - リアルタイムバリデーション

- [ ] `feat: レシピ検索・フィルター画面`
  - 検索バーコンポーネント
  - カテゴリフィルター（和食、洋食、中華等）
  - 調理時間フィルター
  - 難易度フィルター
  - ソート機能（更新日、人気順等）

- [ ] `feat: React Query を使用したデータ管理`
  - モックAPI用のカスタムフック作成
  - キャッシュ戦略の実装
  - オプティミスティックアップデート
  - エラーハンドリング

- [ ] `test: 各画面のスナップショットテストとインタラクションテスト`
  - 画面レンダリングテスト
  - ユーザーインタラクションテスト

### Epic 3: YouTube動画解析UI実装 (PR: feat/youtube-analysis-ui)

#### TODO リスト:

- [ ] `feat: YouTube URL入力画面の実装`
  - URL入力フォームコンポーネント
  - URLバリデーション（YouTube URL形式チェック）
  - 最近の解析履歴表示
  - クリップボードからの貼り付け機能

- [ ] `feat: 解析進行状況画面の実装`
  - プログレスバー表示
  - 各ステップの状態表示（動画取得、音声解析、レシピ構造化）
  - アニメーション効果
  - キャンセル機能
  - エラー状態の表示

- [ ] `feat: 解析結果プレビュー画面`
  - 抽出されたレシピのプレビュー表示
  - 編集可能なフィールド
  - 保存前の確認UI
  - 再解析オプション

- [ ] `feat: モック解析処理の実装`
  - 段階的な進行状況シミュレーション
  - ランダムな成功/失敗パターン
  - サンプルレシピデータの生成

- [ ] `test: 解析フローのE2Eテスト`
  - URL入力から保存までのフローテスト
  - エラーケースのテスト

### Epic 4: 認証画面UI実装（モック認証）(PR: feat/auth-ui-mock)

#### TODO リスト:

- [ ] `feat: ログイン画面UIの実装`
  - ロゴとアプリ説明
  - Googleログインボタン
  - Appleログインボタン（iOS）
  - ローディング状態の管理
  - エラーメッセージ表示

- [ ] `feat: モック認証サービスの実装`
  - ログイン状態のシミュレーション
  - ユーザー情報の保存（AsyncStorage）
  - 自動ログイン機能

- [ ] `feat: プロフィール画面の実装`
  - ユーザー情報表示
  - プラン情報表示（無料/プレミアム）
  - 設定項目一覧
  - ログアウト機能

- [ ] `feat: 設定画面の実装`
  - 通知設定
  - テーマ切り替え（ライト/ダーク）
  - 言語設定
  - キャッシュクリア

- [ ] `test: 認証フローのテスト`
  - ログイン/ログアウトフローテスト
  - 認証状態の永続化テスト

### Epic 5: 共通UIコンポーネントライブラリ (PR: feat/ui-component-library)

#### TODO リスト:

- [ ] `feat: 基本UIコンポーネントの作成`
  - カスタムボタンコンポーネント（各種バリエーション）
  - 入力フィールドコンポーネント
  - カードコンポーネント
  - モーダルコンポーネント
  - トーストメッセージコンポーネント

- [ ] `feat: レシピ特化コンポーネントの作成`
  - 材料アイテムコンポーネント
  - 調理手順アイテムコンポーネント
  - 栄養情報表示コンポーネント
  - 調理時間表示コンポーネント
  - 難易度表示コンポーネント

- [ ] `feat: アニメーションコンポーネント`
  - スケルトンローディング
  - フェードイン/アウト効果
  - スライドアニメーション
  - プルトゥリフレッシュアニメーション

- [ ] `feat: Storybookの設定と各コンポーネントのストーリー作成`
  - Storybook for React Native の設定
  - 各コンポーネントのストーリー作成
  - インタラクティブなプレビュー

- [ ] `test: コンポーネントの単体テスト`
  - 各コンポーネントのレンダリングテスト
  - プロップスのテスト

---

## Phase 2: バックエンド基盤とAPI実装

### Epic 6: Firebase Functions 基本セットアップ (PR: feat/setup-firebase-functions)

#### TODO リスト:

- [ ] `feat: Firebase Functions プロジェクトの初期構造を作成`
  - functions/src ディレクトリ構造の作成
  - TypeScript設定ファイル（tsconfig.json）の作成
  - ESLint設定の追加

- [ ] `feat: Express.js を使用したAPIゲートウェイの実装`
  - Express アプリケーションの初期化
  - CORS設定の追加
  - 基本的なミドルウェアの設定

- [ ] `feat: Firebase Admin SDK の初期化とヘルパー関数の作成`
  - Admin SDK の初期化
  - Firestore、Storage、Auth のヘルパー関数作成
  - 環境変数の設定

- [ ] `feat: エラーハンドリングミドルウェアの実装`
  - 統一エラーレスポンス形式の定義
  - カスタムエラークラスの作成
  - グローバルエラーハンドラーの実装

- [ ] `test: Firebase Functions の基本的なユニットテストを追加`
  - Jest設定の追加
  - 基本的なテストケースの作成

- [ ] `chore: Firebase エミュレーター設定とデプロイスクリプトの追加`
  - firebase.json の設定
  - package.json のスクリプト更新
  - .gitignore の更新

### Epic 7: YouTube動画解析エンジン (PR: feat/youtube-analysis-engine)

#### TODO リスト:

- [ ] `feat: YouTube Data API v3 統合サービスの実装`
  - API クライアントの作成
  - 動画メタデータ取得機能
  - エラーハンドリングとリトライロジック

- [ ] `feat: 動画URL検証とメタデータ抽出機能`
  - URL パターン検証
  - 動画情報の取得と検証
  - 料理動画判定ロジックの実装

- [ ] `feat: Cloud Speech-to-Text 統合サービスの実装`
  - 音声ダウンロード機能
  - Speech-to-Text API 呼び出し
  - トランスクリプト処理

- [ ] `feat: 字幕・説明文取得機能の実装`
  - YouTube字幕の取得
  - 動画説明文のパース
  - テキストデータの前処理

- [ ] `feat: Gemini API を使用したレシピ抽出エンジン`
  - プロンプトエンジニアリング
  - レシピ構造化処理
  - 信頼度スコアリング

- [ ] `feat: 非同期解析ジョブ管理システムの実装`
  - ジョブキューの実装
  - 進行状況追跡
  - タイムアウト処理

- [ ] `test: 解析エンジンの包括的テスト追加`
  - モックを使用した単体テスト
  - 実際のAPIを使用した統合テスト

### Epic 8: レシピ管理CRUD API (PR: feat/recipe-crud-api)

#### TODO リスト:

- [ ] `feat: レシピCRUD エンドポイントの実装`
  - POST /recipes エンドポイント
  - GET /recipes エンドポイント（一覧）
  - GET /recipes/:id エンドポイント
  - PUT /recipes/:id エンドポイント
  - DELETE /recipes/:id エンドポイント

- [ ] `feat: レシピデータバリデーションの実装`
  - Joi スキーマの定義
  - リクエストバリデーションミドルウェア
  - データサニタイゼーション

- [ ] `feat: Firestore レシピコレクション操作の実装`
  - データモデルの実装
  - インデックスの作成
  - トランザクション処理

- [ ] `feat: ページネーションとフィルタリング機能`
  - カーソルベースページネーション
  - 検索機能の実装
  - ソート機能の実装

- [ ] `feat: レシピ画像アップロード機能`
  - Cloud Storage 統合
  - 画像リサイズ処理
  - サムネイル生成

- [ ] `test: CRUD API の統合テスト追加`
  - 各エンドポイントのテスト
  - エラーケースのテスト

### Epic 9: 認証システム実装 (PR: feat/authentication-system)

#### TODO リスト:

- [ ] `feat: Firebase Authentication ヘルパー関数の実装`
  - Google認証の実装
  - Apple認証の実装（iOS）
  - 認証状態管理関数の作成

- [ ] `feat: 認証フローとナビゲーションガードの実装`
  - 認証状態に基づくナビゲーション制御
  - スプラッシュスクリーンでの認証チェック
  - 自動ログイン機能

- [ ] `feat: ユーザープロフィール管理機能の実装`
  - Firestoreへのユーザー情報保存
  - プロフィール更新機能
  - デバイストークンの管理

- [ ] `feat: Functions側の認証ミドルウェア実装`
  - Firebase ID Token検証
  - ユーザー権限チェック
  - レート制限の実装

- [ ] `test: 認証フローの統合テスト追加`
  - ログインフローのE2Eテスト
  - 認証状態管理のテスト

---

## Phase 3: 高度な機能実装

### Epic 10: マルチデバイス同期システム (PR: feat/multi-device-sync)

#### TODO リスト:

- [ ] `feat: デバイス登録・管理APIの実装`
  - デバイス登録エンドポイント
  - デバイス一覧取得
  - デバイス削除機能

- [ ] `feat: Firestore リアルタイムリスナーの実装`
  - 変更検出メカニズム
  - 同期イベントの発火
  - 競合検出ロジック

- [ ] `feat: 競合解決アルゴリズムの実装`
  - タイムスタンプベースの解決
  - 3-way マージロジック
  - ユーザー選択UI

- [ ] `feat: 同期状態管理とUI表示`
  - 同期インジケーター
  - 同期履歴表示
  - エラー通知

- [ ] `feat: バックグラウンド同期処理`
  - 定期同期タスク
  - 差分同期の最適化
  - ネットワーク状態の監視

- [ ] `test: 同期シナリオのE2Eテスト`
  - 複数デバイスでのテスト
  - 競合解決のテスト

### Epic 11: プレミアム機能とサブスクリプション (PR: feat/premium-features)

#### TODO リスト:

- [ ] `feat: アプリ内課金（IAP）の実装`
  - iOS StoreKit 統合
  - Google Play Billing 統合
  - レシート検証

- [ ] `feat: サブスクリプション管理システム`
  - プラン管理ロジック
  - 有効期限チェック
  - 自動更新処理

- [ ] `feat: PDF/CSVエクスポート機能`
  - PDF生成エンジン（jsPDF）
  - CSV生成機能
  - テンプレートシステム

- [ ] `feat: プレミアムユーザー向けUI/UX`
  - 広告非表示処理
  - プレミアムバッジ表示
  - 拡張機能のアンロック

- [ ] `feat: 使用量制限とクォータ管理`
  - API使用量追跡
  - 制限通知システム
  - グレースフルデグレード

- [ ] `test: 課金フローの統合テスト`
  - 購入フローのテスト
  - サブスクリプション更新テスト

### Epic 12: プッシュ通知システム (PR: feat/push-notifications)

#### TODO リスト:

- [ ] `feat: FCM（Firebase Cloud Messaging）の設定`
  - iOS APNs 設定
  - Android FCM 設定
  - トークン管理

- [ ] `feat: 通知送信Function の実装`
  - 通知テンプレート
  - セグメント送信
  - スケジュール送信

- [ ] `feat: アプリ内通知ハンドリング`
  - フォアグラウンド通知
  - バックグラウンド通知
  - 通知タップ処理

- [ ] `feat: 通知設定画面の実装`
  - 通知許可リクエスト
  - カテゴリー別設定
  - 通知履歴

- [ ] `test: 通知配信のE2Eテスト`
  - 各種通知シナリオのテスト
  - デバイス別テスト

---

## Phase 4: 最適化とポリッシュ

### Epic 13: パフォーマンス最適化 (PR: feat/performance-optimization)

#### TODO リスト:

- [ ] `perf: React Native アプリの起動時間最適化`
  - 遅延ロードの実装
  - コード分割
  - アセット最適化

- [ ] `perf: Functions のコールドスタート対策`
  - ウォームアップFunction
  - 依存関係の最小化
  - メモリ設定の調整

- [ ] `perf: Firestore クエリの最適化`
  - 複合インデックスの作成
  - クエリの効率化
  - バッチ処理の実装

- [ ] `perf: 画像ローディングの最適化`
  - 遅延ローディング
  - キャッシュ戦略
  - WebP対応

- [ ] `perf: ネットワークリクエストの最適化`
  - リクエストバッチング
  - GraphQL導入検討
  - キャッシュヘッダー設定

- [ ] `test: パフォーマンステストの追加`
  - 負荷テスト
  - メモリリークテスト

### Epic 14: セキュリティ強化 (PR: feat/security-enhancements)

#### TODO リスト:

- [ ] `security: Firestore セキュリティルールの強化`
  - 本番用ルールの作成
  - ロールベースアクセス制御
  - データ検証ルール

- [ ] `security: API エンドポイントのセキュリティ強化`
  - レート制限の実装
  - DDoS対策
  - 入力値サニタイゼーション

- [ ] `security: 認証セキュリティの向上`
  - 2要素認証の実装
  - セッション管理
  - 不正アクセス検知

- [ ] `security: データ暗号化の実装`
  - 保存時暗号化
  - 通信時暗号化
  - キー管理

- [ ] `test: セキュリティ監査とペネトレーションテスト`
  - OWASP チェックリスト
  - 脆弱性スキャン

### Epic 15: 分析とモニタリング (PR: feat/analytics-monitoring)

#### TODO リスト:

- [ ] `feat: Google Analytics 統合`
  - イベントトラッキング
  - ユーザー行動分析
  - コンバージョン追跡

- [ ] `feat: クラッシュ報告システム（Crashlytics）`
  - クラッシュ報告設定
  - エラーグルーピング
  - アラート設定

- [ ] `feat: パフォーマンスモニタリング`
  - Firebase Performance
  - カスタムメトリクス
  - ダッシュボード作成

- [ ] `feat: ビジネスメトリクスダッシュボード`
  - 使用統計の可視化
  - 収益レポート
  - ユーザー行動分析

- [ ] `feat: アラートとインシデント管理`
  - Cloud Monitoring設定
  - Slack/Discord通知
  - オンコール体制

- [ ] `test: モニタリングシステムのテスト`
  - アラート発火テスト
  - ダッシュボード検証

---

## Phase 5: リリース準備

### Epic 16: アプリストア対応 (PR: feat/app-store-preparation)

#### TODO リスト:

- [ ] `feat: iOS App Store 向け準備`
  - App Store Connect 設定
  - スクリーンショット作成
  - アプリ説明文作成

- [ ] `feat: Google Play Store 向け準備`
  - Play Console 設定
  - ストア掲載情報
  - コンテンツレーティング

- [ ] `feat: アプリアイコンとスプラッシュスクリーン`
  - 各解像度のアイコン作成
  - スプラッシュスクリーン実装
  - ブランディング統一

- [ ] `feat: 多言語対応（i18n）`
  - 日本語リソース
  - 英語リソース
  - 言語切り替え機能

- [ ] `chore: ビルド設定とCI/CD`
  - プロダクションビルド設定
  - 自動化されたビルドパイプライン
  - テスト配信設定

- [ ] `test: リリース前の最終テスト`
  - 各デバイスでの動作確認
  - アップグレードテスト

### Epic 17: ドキュメントと保守体制 (PR: docs/final-documentation)

#### TODO リスト:

- [ ] `docs: ユーザーマニュアルの作成`
  - 使い方ガイド
  - FAQ
  - トラブルシューティング

- [ ] `docs: 開発者ドキュメントの更新`
  - API ドキュメント
  - アーキテクチャ図
  - デプロイ手順

- [ ] `docs: 運用マニュアルの作成`
  - 監視手順
  - インシデント対応
  - バックアップ手順

- [ ] `feat: サポート体制の構築`
  - お問い合わせフォーム
  - サポートチケットシステム
  - ナレッジベース

- [ ] `chore: 保守計画の策定`
  - アップデート計画
  - セキュリティパッチ
  - 機能追加ロードマップ

---

## 実装優先順位（更新版）

1. **Phase 1**: React Native UI開発（モックAPI使用）- **最優先**
   - Epic 1-5: UIファーストでアプリの見た目と動作を確立
2. **Phase 2**: バックエンド基盤とAPI実装
   - Epic 6-9: 実際のAPI実装と認証システム
3. **Phase 3**: 高度な機能実装（MVP後に実装）
   - Epic 10-12: 同期、プレミアム機能、通知
4. **Phase 4**: 最適化とポリッシュ（リリース前に実装）
   - Epic 13-15: パフォーマンス、セキュリティ、分析
5. **Phase 5**: リリース準備（リリース直前）
   - Epic 16-17: ストア対応とドキュメント

## 見積もり工数（更新版）

- **Phase 1**: 3-4週間（UIに注力するため少し長め）
- **Phase 2**: 3-4週間（モックからの移行含む）
- **Phase 3**: 3-4週間
- **Phase 4**: 2-3週間
- **Phase 5**: 1-2週間

**合計**: 約3-4ヶ月（1人開発の場合）

## UI開発優先のメリット

1. **早期フィードバック**: 動作するプロトタイプで早期にUX検証可能
2. **並行開発**: UIが固まった後、バックエンド開発を並行して進められる
3. **デザイン修正**: APIに依存しないため、UIの修正が容易
4. **デモ可能**: ステークホルダーに早期に見せられる
5. **モチベーション維持**: 目に見える成果で開発意欲を維持

## 注意事項

- 各Epicは独立したPRとして実装し、レビューを受ける
- TODOは意味のある単位でコミットする（conventional commits形式）
- テストは各機能と同時に実装する
- ドキュメントは実装と並行して更新する
- 定期的にmainブランチとの同期を行う
